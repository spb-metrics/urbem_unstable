<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.20" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 2.5.0.v20090603 Build &lt;2.5.0.v20090617-0630></property>
    <property name="units">in</property>
    <property name="comments">Copyright (c) 2007 &lt;&lt;Your Company Name here>></property>
    <text-property name="displayName">Template Urbem Paisagem</text-property>
    <property name="layoutPreference">auto layout</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">../../../../../../gestaoAdministrativa/fontes/RPT/framework/library/urbem_221.rptlibrary</property>
            <property name="namespace">urbem_221</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="term_user" id="6666">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="exercicio" id="186">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="cod_acao" id="187">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="db_driver" id="188">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <simple-property-list name="defaultValue">
                <value type="constant">org.postgresql.Driver</value>
            </simple-property-list>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="db_conn_url" id="189">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <simple-property-list name="defaultValue">
                <value type="constant">jdbc:postgresql://172.16.30.5:5432/gp_mariana_0701_1920_5</value>
            </simple-property-list>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="db_user" id="190">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <simple-property-list name="defaultValue">
                <value type="constant">sw.suporte</value>
            </simple-property-list>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="db_password" id="191">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <simple-property-list name="defaultValue">
                <value type="constant">suporte</value>
            </simple-property-list>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="entidade" id="1123">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">integer</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="cod_natureza" id="1176">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="cod_grupo" id="1177">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="cod_especie" id="1178">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="cod_entidade" id="1179">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="data_inicial" id="1180">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="data_final" id="1181">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="ordenacao" id="1182">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="stDescricaoBem" id="1184">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="agrupar" id="6667">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="cod_local" id="6668">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="sql" id="6669">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="cod_orgao" id="6671">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="cod_organograma" id="6672">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="bem_baixado" id="6710">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="postgres" id="1135">
            <method name="beforeOpen"><![CDATA[if ( params["db_driver"].value ){
                extensionProperties.odaDriverClass = params["db_driver"].value;
                extensionProperties.odaURL = params["db_conn_url"].value;
                extensionProperties.odaUser = params["db_user"].value;
extensionProperties.odaPassword = params["db_password"].value;
 extensionProperties.charSet = "utf8";
            }]]></method>
            <property name="odaDriverClass">org.postgresql.Driver</property>
            <property name="odaURL">jdbc:postgresql://172.16.30.5:5432/gp_mariana_0701_1920_5</property>
            <property name="odaUser">sw.suporte</property>
            <encrypted-property name="odaPassword" encryptionID="base64">c3Vwb3J0ZQ==</encrypted-property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="RsBemEntidade" id="1171">
            <structure name="cachedMetaData"/>
            <method name="beforeOpen"><![CDATA[this.queryText = this.queryText + " WHERE entidade.cod_entidade = " +params['cod_entidade']+" "

this.queryText = this.queryText + " AND bem.dt_aquisicao BETWEEN TO_DATE('"+params['data_inicial']+"', 'dd/mm/yyyy') AND TO_DATE('"+params['data_final']+"', 'dd/mm/yyyy')";

if (params['cod_natureza'] != ''){
	this.queryText = this.queryText + " AND bem.cod_natureza = " +params['cod_natureza']+" "
}

if (params['cod_grupo'] != ''){
	this.queryText = this.queryText + " AND bem.cod_grupo = " +params['cod_grupo']+" "
}

if (params['cod_especie'] != ''){
	this.queryText = this.queryText + " AND bem.cod_especie = " +params['cod_especie']+" "
}

if (params['stDescricaoBem'] != ''){
    this.queryText += " AND bem.descricao ILIKE '"+params['stDescricaoBem']+ "'";
}

if (params['cod_local'] != ''){
    this.queryText += " AND local.cod_local = "+params['cod_local'] ;
}

if (params['cod_orgao'] != ''){
    this.queryText += " AND vw_orgao_nivel.orgao ILIKE '"+params['cod_orgao']+"'" ;
}

if (params['cod_organograma'] != ''){
    this.queryText += " AND vw_orgao_nivel.cod_organograma = "+params['cod_organograma'];
}

if (params['bem_baixado'] != '' &amp;&amp; params['bem_baixado'] == 'nao'){
	this.queryText = this.queryText + " AND NOT EXISTS ( SELECT 1 FROM patrimonio.bem_baixado bb WHERE bb.cod_bem = bem.cod_bem) ";
}		    

if (params['ordenacao'] == 'cod_bem'){
	this.queryText = this.queryText + " ORDER BY codigo" + " "
}

if (params['ordenacao'] == 'descricao'){
	this.queryText = this.queryText +" ORDER BY UPPER(bem.descricao)" + " "
}

if (params['ordenacao'] == 'classificacao'){
	this.queryText = this.queryText + " ORDER BY classificacao "
}

if (params['ordenacao'] == 'organograma'){
	this.queryText = this.queryText + " ORDER BY vw_orgao_nivel.orgao "
}

if (params['ordenacao'] == 'local'){
	this.queryText = this.queryText + " ORDER BY local.descricao "
}

params['sql'] = this.queryText;
]]></method>
            <property name="dataSource">postgres</property>
            <xml-property name="queryText"><![CDATA[     SELECT bem.cod_natureza|| '.' ||bem.cod_grupo|| '.' ||bem.cod_especie AS classificacao  
          , bem.cod_bem AS codigo  
          , bem.descricao AS descricao  
          , bem_comprado.exercicio                                                            
          , bem_comprado.cod_empenho||'/'||bem_comprado.exercicio AS empenho  
          , local.descricao AS local  
          , vw_orgao_nivel.orgao as orgao
  
       FROM patrimonio.bem 
  
  LEFT JOIN (SELECT h.*
                 FROM patrimonio.historico_bem as h
                    , patrimonio.historico_bem as uhb
                where h.cod_bem = uhb.cod_bem
             group by h.cod_bem
                    , h.cod_situacao
                    , h.cod_local
                    , h.cod_orgao
                    , h.timestamp
                    , h.descricao having h.timestamp = max(uhb.timestamp)) as hb
         ON hb.cod_bem = bem.cod_bem  

 INNER JOIN organograma.local
         ON local.cod_local = hb.cod_local         
      
 INNER JOIN organograma.orgao
         ON orgao.cod_orgao = hb.cod_orgao   

 INNER JOIN organograma.vw_orgao_nivel
         ON orgao.cod_orgao = vw_orgao_nivel.cod_orgao   
      
  LEFT JOIN patrimonio.bem_comprado
         ON hb.cod_bem = bem_comprado.cod_bem
     
 INNER JOIN orcamento.entidade
         ON bem_comprado.cod_entidade = entidade.cod_entidade
        AND bem_comprado.exercicio = entidade.exercicio
  

]]></xml-property>
        </oda-data-set>
    </data-sets>
    <styles>
        <style name="crosstab" id="4">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
        <style name="crosstab-cell" id="5">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
        <style name="NewStyle" id="1145">
            <property name="fontFamily">sans-serif</property>
            <property name="fontSize">8pt</property>
        </style>
        <style name="padrao_urbem" id="1146">
            <property name="fontFamily">sans-serif</property>
            <property name="fontSize">8pt</property>
        </style>
    </styles>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">a4</property>
            <property name="orientation">landscape</property>
            <property name="topMargin">0.3in</property>
            <property name="leftMargin">0.32608695652173914in</property>
            <property name="bottomMargin">0.21in</property>
            <property name="rightMargin">0.1in</property>
            <page-header>
                <grid name="cabecalho" id="6" extends="urbem_221.cabecalho">
                    <property name="width">283mm</property>
                </grid>
            </page-header>
            <page-footer>
                <grid name="rodape" id="1134" extends="urbem_221.rodape">
                    <property name="marginTop">0pt</property>
                    <property name="width">285mm</property>
                </grid>
            </page-footer>
        </simple-master-page>
    </page-setup>
    <body>
        <table id="1147">
            <property name="pageBreakBefore">auto</property>
            <property name="pageBreakInside">auto</property>
            <property name="height">0.532608695652174in</property>
            <property name="width">11.130434782608695in</property>
            <property name="dataSet">RsBemEntidade</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">classificacao</property>
                    <property name="displayName">classificacao</property>
                    <expression name="expression">dataSetRow["classificacao"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">codigo</property>
                    <property name="displayName">codigo</property>
                    <expression name="expression">dataSetRow["codigo"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">descricao</property>
                    <property name="displayName">descricao</property>
                    <expression name="expression">dataSetRow["descricao"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">local</property>
                    <property name="displayName">local</property>
                    <expression name="expression">dataSetRow["local"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">local_</property>
                    <property name="displayName">agrupar</property>
                    <expression name="expression">if (params["agrupar"].value == "classificacao") {
'Classificação: '+row["classificacao"];
} else if (params["agrupar"].value == "local") {
'Local: '+row["local"];
} else if (params["agrupar"].value == "organograma") {
'Órgão: '+row["orgao"];
}</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">orgao</property>
                    <expression name="expression">dataSetRow["orgao"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <property name="repeatHeader">true</property>
            <property name="pageBreakInterval">33</property>
            <column id="1163">
                <property name="width">1in</property>
            </column>
            <column id="1164">
                <property name="width">0.967391304347826in</property>
            </column>
            <column id="1165">
                <property name="width">5.206521739130435in</property>
            </column>
            <column id="1166">
                <property name="width">3.9456521739130435in</property>
            </column>
            <header>
                <row id="1148">
                    <property name="height">0.1pt</property>
                    <property name="backgroundColor">#E5E5E5</property>
                    <property name="borderBottomColor">#000000</property>
                    <property name="borderBottomStyle">solid</property>
                    <property name="borderBottomWidth">thin</property>
                    <property name="borderLeftColor">#000000</property>
                    <property name="borderLeftStyle">solid</property>
                    <property name="borderLeftWidth">thin</property>
                    <property name="borderRightColor">#000000</property>
                    <property name="borderRightStyle">solid</property>
                    <property name="borderRightWidth">thin</property>
                    <property name="borderTopColor">#000000</property>
                    <property name="borderTopStyle">solid</property>
                    <property name="borderTopWidth">thin</property>
                    <cell id="1149">
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <label id="1167">
                            <property name="fontFamily">sans-serif</property>
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">left</property>
                            <text-property name="text">Classificação</text-property>
                        </label>
                    </cell>
                    <cell id="1150">
                        <property name="drop">all</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <label id="1183">
                            <property name="fontFamily">sans-serif</property>
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">left</property>
                            <text-property name="text">Código</text-property>
                        </label>
                    </cell>
                    <cell id="1151">
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <label id="1169">
                            <property name="fontFamily">sans-serif</property>
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">left</property>
                            <text-property name="text">Descrição</text-property>
                        </label>
                    </cell>
                    <cell id="1152">
                        <label id="1170">
                            <property name="fontFamily">sans-serif</property>
                            <property name="fontSize">8pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">left</property>
                            <text-property name="text">Localização</text-property>
                        </label>
                    </cell>
                </row>
            </header>
            <group id="6685">
                <property name="groupName">agrupar</property>
                <property name="interval">none</property>
                <property name="sortDirection">asc</property>
                <expression name="keyExpr">if (params["agrupar"].value == "classificacao") {
row["classificacao"];
} else if (params["agrupar"].value == "local") {
row["local"];
} else if (params["agrupar"].value == "organograma") {
row["orgao"];
}</expression>
                <property name="repeatHeader">true</property>
                <property name="hideDetail">false</property>
                <property name="pageBreakAfter">auto</property>
                <property name="pageBreakBefore">auto</property>
                <property name="pageBreakInside">auto</property>
                <header>
                    <row id="6704">
                        <cell id="6705">
                            <property name="colSpan">4</property>
                            <property name="rowSpan">1</property>
                            <label id="6709"/>
                        </cell>
                    </row>
                    <row id="6686">
                        <cell id="6687">
                            <property name="colSpan">4</property>
                            <property name="rowSpan">1</property>
                            <data id="6696">
                                <property name="fontSize">9pt</property>
                                <property name="resultSetColumn">local_</property>
                            </data>
                        </cell>
                    </row>
                </header>
                <footer>
                    <row id="6691">
                        <cell id="6692"/>
                        <cell id="6693"/>
                        <cell id="6694"/>
                        <cell id="6695"/>
                    </row>
                </footer>
            </group>
            <detail>
                <row id="1153">
                    <property name="borderBottomColor">#E5E5E5</property>
                    <property name="borderBottomStyle">solid</property>
                    <property name="borderBottomWidth">1px</property>
                    <cell id="1154">
                        <data id="1172">
                            <property name="fontFamily">sans-serif</property>
                            <property name="fontSize">8pt</property>
                            <property name="resultSetColumn">classificacao</property>
                        </data>
                    </cell>
                    <cell id="1155">
                        <data id="1173">
                            <property name="fontFamily">sans-serif</property>
                            <property name="fontSize">8pt</property>
                            <property name="resultSetColumn">codigo</property>
                        </data>
                    </cell>
                    <cell id="1156">
                        <data id="1174">
                            <property name="fontFamily">sans-serif</property>
                            <property name="fontSize">8pt</property>
                            <property name="resultSetColumn">descricao</property>
                        </data>
                    </cell>
                    <cell id="1157">
                        <data id="1175">
                            <property name="fontFamily">sans-serif</property>
                            <property name="fontSize">8pt</property>
                            <property name="resultSetColumn">local</property>
                        </data>
                    </cell>
                </row>
            </detail>
        </table>
    </body>
</report>
